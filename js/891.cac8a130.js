"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[891,196],{9623:function(e,t,n){n.d(t,{k:function(){return d}});n(4114);var o=n(4479),a=n.p+"img/course.41ad5011.svg",i=n.p+"img/end.0fea751a.svg",r=n.p+"img/location.2c3bbc9a.svg",l=n.p+"img/now.84d14ee6.svg",s=n.p+"img/start.7b041b36.svg";const c={course:a,location:r,now:l,start:s,end:i};var u=n(3617);const d=e=>{let t=[],n=[],a=[];const i=window.Tmapv2,r=t=>{if(t.length>0){const n=new i.LatLngBounds;t.forEach((e=>{n.extend(e)})),e.value.fitBounds(n)}else console.error("Zoom 조정할 경로 데이터가 부족합니다.")},l=(t,n,o)=>new i.Polyline({path:t,strokeColor:n,strokeWeight:o,fillOpacity:1,map:e.value,direction:!0,directionColor:"white"}),s=()=>{n.length>0&&(n.forEach((e=>{e&&"function"===typeof e.setVisible&&e.setVisible(!1)})),n=[])},d=()=>{a.forEach((e=>e.setMap(null))),a=[]},g=e=>{const t=e.length,o=10,a=["#75FFA5","#22F779","#13D168","#07AB56","#008545"];a.forEach(((a,i)=>{const r=Math.floor(t*(.2*i)),s=Math.floor(t*(.2*(i+1))),c=e.slice(r,s+1),u=l(c,a,o);n.push(u)})),r(e)},v=e=>new Promise(((t,n)=>{e.value?n("지도 객체 초기화 실패: 이미 초기화된 상태입니다."):(e.value=new i.Map("map_div",{width:"100%",height:"100%",zoom:15,scaleBar:!1,zoomControl:!1}),t())})),p=t=>{const{latitude:n,longitude:o}=t;if(!e.value||0===n||0===o)return;const i=a.findIndex((e=>e.getPosition().lat()===n&&e.getPosition().lng()===o));-1!==i?(a[i].setMap(null),a.splice(i,1)):console.log("해당 위치에 마커가 없습니다.")},h=t=>{const{latitude:n,longitude:o}=t;return!!(n&&o&&e.value)&&a.some((e=>e.getPosition().lat()===n&&e.getPosition().lng()===o))},f=(t,n)=>{const{latitude:o,longitude:r}=t;if(!e.value||0===o||0===r)return;const l=new i.LatLng(o,r),s=new i.Marker({position:l,icon:c[n],map:e.value});return a.push(s),s},w=async(e,n,a)=>{try{s();const r=a?a.map((e=>`${e.longitude},${e.latitude}`)).join("_"):"",l=await(0,o.N)(String(e.longitude),String(e.latitude),String(n.longitude),String(n.latitude),r);t=[],l.forEach((e=>{const n=e.geometry;e.properties;"LineString"===n.type&&n.coordinates.forEach((e=>{const n=new i.Point(e[0],e[1]),o=i.Projection.convertEPSG3857ToWGS84GEO(n),a=new i.LatLng(o._lat,o._lng);t.push(a)}))})),g(t)}catch(r){console.error("경로 검색 중 오류 발생:",r)}},m=async e=>{const a=[33.433944015499456,126.43602130714433],r=[33.45120886113757,126.48765563964844],l="126.39573248492509,33.47190207955216_126.44226001173622,33.47486469122896_126.42766879469521,33.48001928930712";try{const s=await(0,o.N)(String(a[1]),String(a[0]),String(r[1]),String(r[0]),l);n.length>0&&(n.forEach((e=>e.setMap(null))),n=[]),t=[],s.forEach((n=>{const o=n.geometry,a=n.properties;if("LineString"===o.type)o.coordinates.forEach((e=>{const n=new i.Point(e[0],e[1]),o=i.Projection.convertEPSG3857ToWGS84GEO(n),a=new i.LatLng(o._lat,o._lng);t.push(a)}));else if("GP"!==a.pointType&&a.pointType.includes("PP")){const t=new i.Point(o.coordinates[0],o.coordinates[1]),n=i.Projection.convertEPSG3857ToWGS84GEO(t);new i.Marker({position:new i.LatLng(n._lat,n._lng),icon:c["location"],map:e.value})}})),g(t)}catch(s){console.error("경로 검색 중 오류 발생:",s)}},k=(t,n)=>{if(e.value)if(isNaN(t)||isNaN(n))console.error("유효하지 않은 좌표:",t,n);else{const o=new i.LatLng(t,n);e.value.setCenter(o),e.value.setZoom(15)}},P=async()=>{if(!e.value)return;let t,n;try{[t,n]=await(0,u.v)();const o=new i.LatLng(t,n);new i.Marker({position:o,icon:c["now"],map:e.value})}catch(o){[t,n]=[33.50712081595116,126.49340629577637],console.error("현재 위치를 찾을 수 없습니다:",o)}k(t,n)};return{initTmap:v,removeMarker:p,searchRoutes:w,addMarker:f,clearMarkers:d,checkDuplMarker:h,moveLocation:k,searchRoutesTest:m,moveNowLocation:P}}},16:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var o=n(6768),a=n(144),i=n(9623),r=n(6502),l=n(2098),s=n(5234),c=n(6884);const u=e=>((0,o.Qi)("data-v-9f5b3414"),e=e(),(0,o.jt)(),e),d={class:"container"},g=u((()=>(0,o.Lk)("div",{id:"map_div"},null,-1)));var v=(0,o.pM)({__name:"CreateCourse",setup(e){const t=(0,c._)(),{page:n,showSearch:u,startPointValid:v,endPointValid:p,wayPointsValid:h,wayPoint:f,endPoint:w,startPoint:m}=(0,s.bP)(t),k=(0,a.KR)(null),{initTmap:P,addMarker:y,searchRoutes:L,removeMarker:S,checkDuplMarker:E,moveNowLocation:M}=(0,i.k)(k),_={1:l.gu,2:l.SC,3:l.sg,4:l.rc,11:l.xC,12:l.wf};(0,o.sV)((async()=>{await P(k),await M()}));const b=(e,t,n)=>{if(e&&v.value){const t=E(e);t||y(e,n)}!t||e.name===t.name&&e.longitude===t.longitude&&e.latitude===t.latitude||S(t)},C=()=>{v.value&&p.value&&h.value&&L(m.value,w.value,f.value)};return(0,o.wB)((()=>m.value),((e,t)=>{b(e,t,"start")}),{deep:!0}),(0,o.wB)((()=>w.value),((e,t)=>{b(e,t,"end")}),{deep:!0}),(0,o.wB)((()=>[...f.value]),((e,t)=>{if(e.forEach(((e,n)=>{const o=t[n];b(e,o,"location")})),e.length<t.length)for(let n=e.length;n<t.length;n++)S(t[n])}),{deep:!0}),(0,o.wB)((()=>[f.value,m.value,w.value]),C,{deep:!0}),(e,t)=>((0,o.uX)(),(0,o.CE)("div",d,[(0,a.R1)(u)?((0,o.uX)(),(0,o.Wv)((0,a.R1)(l.V0),{key:0})):(0,o.Q3)("",!0),g,(0,o.bF)((0,a.R1)(r.o),null,{default:(0,o.k6)((()=>[(0,a.R1)(u)?((0,o.uX)(),(0,o.Wv)((0,a.R1)(l.q0),{key:0})):_[(0,a.R1)(n)]?((0,o.uX)(),(0,o.Wv)((0,o.$y)(_[(0,a.R1)(n)]),{key:1})):(0,o.Q3)("",!0)])),_:1})]))}}),p=n(1241);const h=(0,p.A)(v,[["__scopeId","data-v-9f5b3414"]]);var f=h}}]);
//# sourceMappingURL=891.cac8a130.js.map