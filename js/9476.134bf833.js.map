{"version":3,"file":"js/9476.134bf833.js","mappings":"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","sources":["webpack://frontend/./src/apis/authorityFeature/index.ts","webpack://frontend/./src/views/auth/FindPasswordByPhone.vue?d91c","webpack://frontend/./src/views/auth/FindPasswordByPhone.vue","webpack://frontend/./src/views/auth/FindPasswordByPhone.vue?ef1d"],"sourcesContent":["import axios from 'axios';\n\nconst headers: Record<string, string> = {\n  'Content-Type': 'application/json',\n};\n\nconst handleAxiosError = (error: unknown) => {\n  const errorCode =\n    axios.isAxiosError(error) && error.response\n      ? error.response.data.errorCode\n      : null;\n  throw { originalError: error, errorCode };\n};\n\nexport const sendSms = async (name: string, phoneNumber: string) => {\n  try {\n    const url = `${process.env.VUE_APP_BASE_API}/api/v1/auth/sms/send`;\n    const data = { name, phoneNumber };\n    const response = await axios.post(url, data, {\n      headers,\n    });\n\n    return response.data;\n  } catch (error) {\n    handleAxiosError(error);\n  }\n};\n\nexport const checkSms = async (\n  name: string,\n  phoneNumber: string,\n  verificationCode: string\n) => {\n  try {\n    const url = `${process.env.VUE_APP_BASE_API}/api/v1/auth/sms/check`;\n    const data = { name, phoneNumber, verificationCode };\n    const response = await axios.post(url, data, {\n      headers,\n    });\n\n    return response.data;\n  } catch (error) {\n    handleAxiosError(error);\n  }\n};\n\nexport const sendSmsLater = async (name: string, phoneNumber: string) => {\n  try {\n    const url = `${process.env.VUE_APP_BASE_API}/api/v1/auth/sms/send/later`;\n    const data = { name, phoneNumber };\n    const response = await axios.post(url, data, {\n      headers,\n    });\n\n    return response.data;\n  } catch (error) {\n    handleAxiosError(error);\n  }\n};\n\nexport const sendEmail = async (email: string) => {\n  try {\n    const url = `${process.env.VUE_APP_BASE_API}/api/v1/auth/authentication/send`;\n    const response = await axios.post(\n      url,\n      { email },\n      {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n    );\n    return response.data;\n  } catch (error) {\n    const errorCode =\n      axios.isAxiosError(error) && error.response\n        ? error.response.data.errorCode\n        : null;\n    throw { originalError: error, errorCode };\n  }\n};\n\nexport const checkEmail = async (email: string, authCode: string) => {\n  try {\n    const url = `${process.env.VUE_APP_BASE_API}/api/v1/auth/authentication/check`;\n    const data = { email, authCode };\n    const response = await axios.post(url, data, {\n      headers,\n    });\n\n    return response.data;\n  } catch (error) {\n    handleAxiosError(error);\n  }\n};\n\nexport const findUserId = async (name: string, phoneNumber: string) => {\n  try {\n    const url = `${process.env.VUE_APP_BASE_API}/api/v1/auth/find/id`;\n    const data = { name, phoneNumber };\n    const response = await axios.post(url, data);\n\n    return response.data;\n  } catch (error) {\n    handleAxiosError(error);\n  }\n};\n\nexport const sendEmailLater = async (email: string, authCode: string) => {\n  try {\n    const url = `${process.env.VUE_APP_BASE_API}/api/v1/auth/authentication/check/later`;\n    const data = { email, authCode };\n    const response = await axios.post(url, data);\n\n    return response.data;\n  } catch (error) {\n    handleAxiosError(error);\n  }\n};\n\nexport const checkId = async (email: string) => {\n  try {\n    const url = `${process.env.VUE_APP_BASE_API}/api/v1/auth/check/id`;\n    const data = { email };\n    const response = await axios.post(url, data);\n\n    return response.data;\n  } catch (error) {\n    handleAxiosError(error);\n  }\n};\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = (n: any) => (_pushScopeId(\"data-v-d3d2fec6\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"find-password-container\" }\nconst _hoisted_2 = { class: \"find-input\" }\nconst _hoisted_3 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1))\nconst _hoisted_4 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1))\nconst _hoisted_5 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1))\n\nimport { Button, Input, ResentTimer } from '@/components';\r\nimport { useRouter } from 'vue-router';\r\nimport { reactive, ref } from 'vue';\r\nimport { sendSmsLater, checkSms, findUserId } from '@/apis/authorityFeature';\r\nimport { useSignUpIDStore } from '@/stores/auth';\r\nimport { storeToRefs } from 'pinia';\r\nimport { autoHyphen, validatePhoneNumber } from '@/utils';\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'FindPasswordByPhone',\n  setup(__props) {\n\r\nconst router = useRouter();\r\nconst signUpIDStore = useSignUpIDStore();\r\nconst { inputState, inputMessage } = storeToRefs(signUpIDStore);\r\n\r\nconst state = reactive({\r\n  verificationSent: false,\r\n  verificationExpired: false,\r\n  verificationStart: null, // 타이머 시작 여부\r\n});\r\n\r\nconst name = ref('');\r\nconst nameState = ref('default');\r\nconst phoneNumber = ref('');\r\nconst phoneNumberState = ref('default');\r\nconst verificationCode = ref('');\r\nconst codeState = ref('default');\r\nconst codeMessage = ref('');\r\nconst userId = ref('');\r\n\r\nconst handleTimeout = () => {\r\n  state.verificationExpired = true;\r\n  state.verificationSent = false;\r\n  state.verificationStart = null;\r\n};\r\n\r\nconst sendVerificationCode = async () => {\r\n  if (name.value.length === 0) {\r\n    nameState.value = 'error';\r\n    return;\r\n  }\r\n  nameState.value = 'default';\r\n\r\n  const cleanedPhoneNumber = phoneNumber.value.replace(/-/g, '');\r\n  if (!validatePhoneNumber(cleanedPhoneNumber)) {\r\n    phoneNumberState.value = 'error';\r\n    return;\r\n  }\r\n  phoneNumberState.value = 'default';\r\n\r\n  try {\r\n    await sendSmsLater(name.value, cleanedPhoneNumber);\r\n    state.verificationSent = true;\r\n    state.verificationStart = Date.now();\r\n    inputState.value = 'default';\r\n    inputMessage.value = '';\r\n  } catch (error) {\r\n    const smsError = error as { errorCode: string | null };\r\n    if (smsError.errorCode === 'INVALID_VALUE_04') {\r\n      inputState.value = 'error';\r\n      inputMessage.value = '이미 계정이 존재합니다.';\r\n    } else if (smsError.errorCode === 'INVALID_VALUE_01') {\r\n      inputState.value = 'error';\r\n      inputMessage.value = '휴대폰 번호를 정확히 입력해주세요.';\r\n    }\r\n  }\r\n};\r\n\r\nconst checkVerificationCode = async () => {\r\n  if (!state.verificationSent) return;\r\n\r\n  try {\r\n    const cleanedPhoneNumber = phoneNumber.value.replace(/-/g, '');\r\n    await checkSms(name.value, cleanedPhoneNumber, verificationCode.value);\r\n    const response = await findUserId(name.value, cleanedPhoneNumber);\r\n\r\n    userId.value = response[0]?.id ?? '';\r\n\r\n    router.push({\r\n      name: 'find-password-reset',\r\n      query: {\r\n        name: name.value,\r\n        phoneNumber: cleanedPhoneNumber,\r\n        userId: userId.value,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    const smsError = error as { errorCode: string | null };\r\n    if (smsError.errorCode === 'AUTH_03') {\r\n      codeState.value = 'error';\r\n      codeMessage.value = '인증번호가 틀렸습니다.';\r\n    }\r\n  }\r\n};\r\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"span\", _hoisted_2, [\n      _createVNode(_unref(Input), {\n        placeholder: \"이름을 입력해주세요\",\n        label: \"이름\",\n        modelValue: name.value,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((name).value = $event)),\n        state: nameState.value\n      }, null, 8, [\"modelValue\", \"state\"]),\n      _createVNode(_unref(Input), {\n        placeholder: \"010-0000-0000\",\n        onInput: _unref(autoHyphen),\n        maxlength: \"13\",\n        label: \"휴대폰 번호\",\n        modelValue: phoneNumber.value,\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((phoneNumber).value = $event)),\n        state: _unref(inputState),\n        message: \"가입 시 등록한 휴대폰 번호를 입력해주세요\"\n      }, null, 8, [\"onInput\", \"modelValue\", \"state\"]),\n      (!state.verificationSent)\n        ? (_openBlock(), _createBlock(_unref(Button), {\n            key: 0,\n            text: \"인증번호 받기\",\n            onClick: sendVerificationCode,\n            style: {\r\n          backgroundColor: 'var(--color-button-secondary)',\r\n          color: 'var(--color-button-on-secondary)',\r\n          height: '44px',\r\n          fontSize: '1.4rem',\r\n        }\n          }))\n        : _createCommentVNode(\"\", true),\n      (state.verificationSent)\n        ? (_openBlock(), _createBlock(_unref(Input), {\n            key: 1,\n            placeholder: \"인증번호 입력\",\n            label: \"인증번호\",\n            modelValue: verificationCode.value,\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((verificationCode).value = $event)),\n            state: codeState.value,\n            message: codeMessage.value\n          }, null, 8, [\"modelValue\", \"state\", \"message\"]))\n        : _createCommentVNode(\"\", true),\n      (state.verificationSent)\n        ? (_openBlock(), _createBlock(_unref(ResentTimer), {\n            key: 2,\n            verificationStart: state.verificationStart,\n            handleTimeout: handleTimeout,\n            onResendSms: sendVerificationCode\n          }, null, 8, [\"verificationStart\"]))\n        : _createCommentVNode(\"\", true)\n    ]),\n    _hoisted_3,\n    _hoisted_4,\n    _hoisted_5,\n    (state.verificationSent)\n      ? (_openBlock(), _createBlock(_unref(Button), {\n          key: 0,\n          class: \"next-button\",\n          onClick: checkVerificationCode,\n          text: \"다음\"\n        }))\n      : _createCommentVNode(\"\", true)\n  ]))\n}\n}\n\n})","<template>\r\n  <div class=\"find-password-container\">\r\n    <span class=\"find-input\">\r\n      <Input\r\n        placeholder=\"이름을 입력해주세요\"\r\n        label=\"이름\"\r\n        v-model=\"name\"\r\n        :state=\"nameState\"\r\n      />\r\n      <Input\r\n        placeholder=\"010-0000-0000\"\r\n        @input=\"autoHyphen\"\r\n        maxlength=\"13\"\r\n        label=\"휴대폰 번호\"\r\n        v-model=\"phoneNumber\"\r\n        :state=\"inputState\"\r\n        message=\"가입 시 등록한 휴대폰 번호를 입력해주세요\"\r\n      />\r\n      <Button\r\n        v-if=\"!state.verificationSent\"\r\n        text=\"인증번호 받기\"\r\n        @click=\"sendVerificationCode\"\r\n        :style=\"{\r\n          backgroundColor: 'var(--color-button-secondary)',\r\n          color: 'var(--color-button-on-secondary)',\r\n          height: '44px',\r\n          fontSize: '1.4rem',\r\n        }\"\r\n      />\r\n      <Input\r\n        v-if=\"state.verificationSent\"\r\n        placeholder=\"인증번호 입력\"\r\n        label=\"인증번호\"\r\n        v-model=\"verificationCode\"\r\n        :state=\"codeState\"\r\n        :message=\"codeMessage\"\r\n      />\r\n      <ResentTimer\r\n        v-if=\"state.verificationSent\"\r\n        :verificationStart=\"state.verificationStart\"\r\n        :handleTimeout=\"handleTimeout\"\r\n        @resendSms=\"sendVerificationCode\"\r\n      />\r\n    </span>\r\n    <br />\r\n    <br />\r\n    <br />\r\n    <Button\r\n      v-if=\"state.verificationSent\"\r\n      class=\"next-button\"\r\n      @click=\"checkVerificationCode\"\r\n      text=\"다음\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { Button, Input, ResentTimer } from '@/components';\r\nimport { useRouter } from 'vue-router';\r\nimport { reactive, ref } from 'vue';\r\nimport { sendSmsLater, checkSms, findUserId } from '@/apis/authorityFeature';\r\nimport { useSignUpIDStore } from '@/stores/auth';\r\nimport { storeToRefs } from 'pinia';\r\nimport { autoHyphen, validatePhoneNumber } from '@/utils';\r\n\r\nconst router = useRouter();\r\nconst signUpIDStore = useSignUpIDStore();\r\nconst { inputState, inputMessage } = storeToRefs(signUpIDStore);\r\n\r\nconst state = reactive({\r\n  verificationSent: false,\r\n  verificationExpired: false,\r\n  verificationStart: null, // 타이머 시작 여부\r\n});\r\n\r\nconst name = ref('');\r\nconst nameState = ref('default');\r\nconst phoneNumber = ref('');\r\nconst phoneNumberState = ref('default');\r\nconst verificationCode = ref('');\r\nconst codeState = ref('default');\r\nconst codeMessage = ref('');\r\nconst userId = ref('');\r\n\r\nconst handleTimeout = () => {\r\n  state.verificationExpired = true;\r\n  state.verificationSent = false;\r\n  state.verificationStart = null;\r\n};\r\n\r\nconst sendVerificationCode = async () => {\r\n  if (name.value.length === 0) {\r\n    nameState.value = 'error';\r\n    return;\r\n  }\r\n  nameState.value = 'default';\r\n\r\n  const cleanedPhoneNumber = phoneNumber.value.replace(/-/g, '');\r\n  if (!validatePhoneNumber(cleanedPhoneNumber)) {\r\n    phoneNumberState.value = 'error';\r\n    return;\r\n  }\r\n  phoneNumberState.value = 'default';\r\n\r\n  try {\r\n    await sendSmsLater(name.value, cleanedPhoneNumber);\r\n    state.verificationSent = true;\r\n    state.verificationStart = Date.now();\r\n    inputState.value = 'default';\r\n    inputMessage.value = '';\r\n  } catch (error) {\r\n    const smsError = error as { errorCode: string | null };\r\n    if (smsError.errorCode === 'INVALID_VALUE_04') {\r\n      inputState.value = 'error';\r\n      inputMessage.value = '이미 계정이 존재합니다.';\r\n    } else if (smsError.errorCode === 'INVALID_VALUE_01') {\r\n      inputState.value = 'error';\r\n      inputMessage.value = '휴대폰 번호를 정확히 입력해주세요.';\r\n    }\r\n  }\r\n};\r\n\r\nconst checkVerificationCode = async () => {\r\n  if (!state.verificationSent) return;\r\n\r\n  try {\r\n    const cleanedPhoneNumber = phoneNumber.value.replace(/-/g, '');\r\n    await checkSms(name.value, cleanedPhoneNumber, verificationCode.value);\r\n    const response = await findUserId(name.value, cleanedPhoneNumber);\r\n\r\n    userId.value = response[0]?.id ?? '';\r\n\r\n    router.push({\r\n      name: 'find-password-reset',\r\n      query: {\r\n        name: name.value,\r\n        phoneNumber: cleanedPhoneNumber,\r\n        userId: userId.value,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    const smsError = error as { errorCode: string | null };\r\n    if (smsError.errorCode === 'AUTH_03') {\r\n      codeState.value = 'error';\r\n      codeMessage.value = '인증번호가 틀렸습니다.';\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.find-password-container {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 20px;\r\n}\r\n\r\n.find-input {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16px;\r\n}\r\n\r\n.next-button {\r\n  margin-top: auto;\r\n  align-self: center;\r\n}\r\n</style>\r\n","import script from \"./FindPasswordByPhone.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FindPasswordByPhone.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FindPasswordByPhone.vue?vue&type=style&index=0&id=d3d2fec6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-d3d2fec6\"]])\n\nexport default __exports__"],"names":["headers","handleAxiosError","error","errorCode","axios","isAxiosError","response","data","originalError","sendSms","async","name","phoneNumber","url","post","checkSms","verificationCode","sendSmsLater","sendEmail","email","checkEmail","authCode","findUserId","sendEmailLater","checkId","_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","class","_hoisted_2","_hoisted_3","_createElementVNode","_hoisted_4","_hoisted_5","_defineComponent","__name","setup","__props","router","useRouter","signUpIDStore","useSignUpIDStore","inputState","inputMessage","storeToRefs","state","reactive","verificationSent","verificationExpired","verificationStart","ref","nameState","phoneNumberState","codeState","codeMessage","userId","handleTimeout","sendVerificationCode","value","length","cleanedPhoneNumber","replace","validatePhoneNumber","Date","now","smsError","checkVerificationCode","id","push","query","_ctx","_cache","_openBlock","_createElementBlock","_createVNode","_unref","Input","placeholder","label","modelValue","$event","onInput","autoHyphen","maxlength","message","_createCommentVNode","_createBlock","Button","key","text","onClick","style","backgroundColor","color","height","fontSize","ResentTimer","onResendSms","__exports__"],"sourceRoot":""}